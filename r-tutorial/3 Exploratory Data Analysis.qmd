---
title: "3 Exploratory Data Analysis"
author: "Mohan Khanal"
date: "2025-08-03"
format:
  html:
    toc: true
    toc-location: left
    toc-title: "Contents"
    toc-depth: 2
  pdf:
    toc: true
    number-sections: true
---

```{r}
# Chapter 3: Exploratory Data Analysis

# Load required libraries
library(dplyr)
library(ggplot2)
library(here)

# Import dataset
#car_data <- read.csv("D:/DemoPractices/R for Data Science/data/car data.csv")



car_data <- read.csv(here("data","car data.csv"))
``` 

# ---- Part 1: Descriptive Statistics ----
## Using Base Package -----
```{r}
# Summary of entire dataset
summary(car_data)

# Base R Descriptive Stats
mean(car_data$Selling_Price, na.rm = TRUE)
median(car_data$Selling_Price, na.rm = TRUE)
sd(car_data$Selling_Price, na.rm = TRUE)
var(car_data$Selling_Price, na.rm = TRUE)
range(car_data$Selling_Price, na.rm = TRUE)
quantile(car_data$Selling_Price, probs = c(0.25, 0.5, 0.75), na.rm = TRUE)
```
## Using dplyr function ----

```{r}
# dplyr group-wise summary
car_data %>%
  group_by(Fuel_Type) %>%
  summarize(
    count = n(),
    avg_price = mean(Selling_Price),
    sd_price = sd(Selling_Price),
    max_price = max(Selling_Price)
  )
```


# ---- Part 2: Data Visualization using Base R ----

```{r}
# Histogram
hist(car_data$Selling_Price, 
     main = "Histogram of Selling Price", 
     xlab = "Selling Price", 
     col = "skyblue", 
     border = "black")
```


```{r}
# Boxplot
boxplot(Selling_Price ~ Fuel_Type, data = car_data,
        main = "Boxplot of Selling Price by Fuel Type",
        xlab = "Fuel Type", ylab = "Selling Price",
        col = "orange")

# Scatter Plot
plot(car_data$Present_Price, car_data$Selling_Price,
     main = "Selling vs Present Price",
     xlab = "Present Price", ylab = "Selling Price",
     pch = 19, col = "darkgreen")

# Bar Plot
fuel_counts <- table(car_data$Fuel_Type)
barplot(fuel_counts, 
        main = "Fuel Type Distribution", 
        col = "purple", 
        xlab = "Fuel Type", 
        ylab = "Count")
```

# ---- Part 3: Data Visualization using ggplot2 (Optional) ----


```{r}
# Scatter Plot
ggplot(car_data, aes(x = Present_Price, y = Selling_Price)) +
  geom_point(color = "blue") +
  labs(title = "Selling vs Present Price", x = "Present Price", y = "Selling Price")

# Boxplot
ggplot(car_data, aes(x = Fuel_Type, y = Selling_Price, fill = Fuel_Type)) +
  geom_boxplot() +
  labs(title = "Selling Price by Fuel Type")

# Histogram
ggplot(car_data, aes(x = Selling_Price)) +
  geom_histogram(fill = "skyblue", color = "black", bins = 15) +
  labs(title = "Histogram of Selling Price", x = "Selling Price")
```


# ---- Part 4: Practice Tasks ----
## Statistics ----
```{r}
# Mean, median, SD of Present_Price
mean(car_data$Present_Price, na.rm = TRUE)
median(car_data$Present_Price, na.rm = TRUE)
sd(car_data$Present_Price, na.rm = TRUE)
```

# Create Car Age and Scatter plot vs selling price ---- 

```{r}
# Create Car_Age variable
car_data <- car_data %>%
  mutate(Car_Age = 2025 - Year)

# Scatter plot of Car_Age vs Selling_Price
plot(car_data$Car_Age, car_data$Selling_Price,
     main = "Car Age vs Selling Price",
     xlab = "Car Age", ylab = "Selling Price",
     pch = 19, col = "darkred")
```

# Boxplot across Transmission ----
```{r}

boxplot(Selling_Price ~ Transmission, data = car_data,
        main = "Selling Price by Transmission",
        xlab = "Transmission", ylab = "Selling Price",
        col = "lightblue")
```

# Count by Seller_Type ----
```{r}
car_data %>%
  group_by(Seller_Type) %>%
  summarize(count = n())
```

# Feedback ----


